---
apiVersion: formol.desmojim.fr/v1alpha1
kind: BackupConfiguration
metadata:
  name: backup-demo
  namespace: demo
spec:
  suspend: true
  image: desmo999r/formolcli:latest
  repository: repo-local
  schedule: "15 * * * *"
  keep:
    last: 5
    daily: 2
    weekly: 2
    monthly: 6
    yearly: 3
  targets:
  - backupType: Online
    targetKind: Deployment
    targetName: apache-deployment
    containers:
      - name: apache
        steps:
          - name: maintenance-on
          - name: maintenance-off
            finalize: true
        paths:
          - /data
  - backupType: Job
    targetKind: StatefulSet
    targetName: postgres-demo
    containers:
      - name: postgres
#  - kind: Job
#    name: backup-pg
#    steps:
#      - name: backup-pg
